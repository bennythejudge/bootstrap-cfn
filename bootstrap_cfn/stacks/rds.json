{
  "RDSSubnetGroup" : {
    "Type" : "AWS::RDS::DBSubnetGroup",
    "Properties" : {
      "DBSubnetGroupDescription" : "VPC Subnets",
      "SubnetIds" : [{ "Ref" : "SubnetA" }, { "Ref" : "SubnetB" }, { "Ref" : "SubnetC" }]
    }
  },
  "DatabaseSG": {
    "Type": "AWS::EC2::SecurityGroup",
    "Properties": {
      "VpcId" : { "Ref" : "VPC" },
      "GroupDescription": "SG for EC2 Access to RDS",
      "SecurityGroupIngress": [
        {
          "CidrIp": { "Fn::FindInMap" : [ "SubnetConfig", "VPC", "CIDR" ]},
          "IpProtocol": "tcp",
          "FromPort": 5432,
          "ToPort": 5432
        },
        {
          "CidrIp": { "Fn::FindInMap" : [ "SubnetConfig", "VPC", "CIDR" ]},
          "IpProtocol": "tcp",
          "FromPort": 3306,
          "ToPort": 3306
        }
      ]
    }
  },
  "RDSInstance": {
    "DependsOn" : "DatabaseSG",
    "Type": "AWS::RDS::DBInstance",
    "Properties": {
      "DBInstanceIdentifier": "",
      "DBName": "",
      "DBInstanceClass": "",
      "MasterUsername": "",
      "MasterUserPassword": "",
      "AllocatedStorage": "",
      "StorageType": "",
      "Engine": "",
      "EngineVersion": "",
      "MultiAZ": "",
      "DBSubnetGroupName": {"Ref" : "RDSSubnetGroup"},
      "VPCSecurityGroups" : [ { "Fn::GetAtt": [ "DatabaseSG", "GroupId" ] } ],
      "PubliclyAccessible": false,
      "AllowMajorVersionUpgrade": false,
      "AutoMinorVersionUpgrade": false
    }
  }
}